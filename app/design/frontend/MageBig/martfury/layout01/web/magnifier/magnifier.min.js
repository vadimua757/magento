!function(e){function n(n,t){function o(e){if("string"==typeof e){if("true"===e)return!0;if("false"===e)return!1;console.warn("Wrong type: can't be transformed to Boolean")}else if("boolean"==typeof e)return e}function a(n){if(e(n).siblings(".magnify-lens").length)return!1;var t=e('<div class="magnify-lens magnify-hidden" data-gallery-role="magnifier-zoom"></div>');e(n).parent().append(t)}function i(n,t,o,a){var i,l=x.find(".magnify-lens");1===j[n].status?(i=e('<div class="magnifier-loader-text"></div>'),l.className="magnifier-loader magnify-hidden",i.html("Loading..."),l.html("").append(i)):2===j[n].status&&(l.addClass(J.magnifyHidden),l.html(""),o.id=n+"-large",o.style.width=j[n].largeW*Q+"px",o.style.height=j[n].largeH+"px",o.className="magnifier-large magnify-hidden","inside"===j[n].mode?l.append(o):a.html("").append(o)),j[n].lensH=j[n].lensH>b.height()?b.height():j[n].lensH,0===Math.round(j[n].lensW)?l.css("display","none"):l.css({width:j[n].lensW+1+"px",height:j[n].lensH-1+"px",display:""})}function l(){var e,n,t=T.x-C.x,o=T.y-C.y;F=!(t<0||o<0||t>C.w||o>C.h),n=t-C.lensW/2,e=o-C.lensH/2,"inside"!==C.mode&&(t<C.lensW/2&&(n=0),o<C.lensH/2&&(e=0),t-C.w+Math.ceil(C.lensW/2)>0&&(n=C.w-Math.ceil(C.lensW+2)),o-C.h+Math.ceil(C.lensH/2)>0&&(e=C.h-Math.ceil(C.lensH)),T.l=n,T.t=e,C.lensBgX=T.l,C.lensBgY=T.t,"inside"===C.mode?(C.largeL=t*(C.zoom-C.lensW/C.w),C.largeT=o*(C.zoom-C.lensH/C.h)):(C.largeL=C.lensBgX*C.zoom*(C.largeWrapperW/C.w)*Q,C.largeT=C.lensBgY*C.zoom*(C.largeWrapperH/C.h)))}function s(){o(E)&&(C=j[N],X=x.find(".magnify-lens"),2===C.status?(X.removeClass(J.magnifyOpaque),Y=e("#"+N+"-large"),Y.removeClass(J.magnifyHidden)):1===C.status&&(X.className="magnifier-loader"))}function r(){if(C.status>0){var e=C.onthumbleave;null!==e&&e({thumb:M,lens:X,large:Y,x:T.x,y:T.y}),X.hasClass(J.magnifyHidden)||(X.addClass(J.magnifyHidden),null!==Y&&Y.addClass(J.magnifyHidden))}}function m(){if(o(E)){if(k!==C.status&&s(),C.status>0){M.className=C.thumbCssClass+" magnify-opaque",1===C.status?X.className="magnifier-loader":2===C.status&&(X.removeClass(J.magnifyHidden),Y.removeClass(J.magnifyHidden),Y.css({left:"-"+C.largeL+"px",top:"-"+C.largeT+"px"})),T.t=T.t<=0?0:T.t,X.css({left:T.l+R+"px",top:T.t+1+D+"px"}),A?X.css({"background-color":"rgba(f,f,f,.5)"}):X.get(0).style.backgroundPosition="-"+C.lensBgX+"px -"+C.lensBgY+"px";var e=C.onthumbmove;null!==e&&e({thumb:M,lens:X,large:Y,x:T.x,y:T.y})}k=C.status}}function u(e,n){var t=e.getBoundingClientRect(),o=0,a=0;n.x=t.left,n.y=t.top,n.w=t.right-n.x,n.h=t.bottom-n.y,"inside"===n.mode?(o=n.w,a=n.h):(o=n.largeWrapperW,a=n.largeWrapperH),n.largeW=n.zoom*o,n.largeH=n.zoom*a,n.lensW=n.w/n.zoom/Q,n.lensH=n.h/n.zoom}function d(e,n){var t={};if(void 0===n.thumb)return!1;if(b=e.find(n.thumb),b.length){for(var a in n)t[a]=n[a];t.thumb=b,E=t.enabled,o(E)?(W.show().css("display",""),W.addClass(J.magnifyHidden),c(t)):W.empty().hide()}return w}function g(n){e(n).on("mouseover",function(e){G&&(0!==C.status&&r(),p(e),P=F)}).trigger("mouseover")}function h(n){e(n).on("click",function(e){G&&(P||(0!==C.status&&r(),p(e),P=!0))})}function f(e,n){switch(e){case"hover":g(n);break;case"click":h(n)}}function p(e){var n=e.target;N=n.id,M=n,s(n),u(M,C),T.x=e.clientX,T.y=e.clientY,l(),m();var t=C.onthumbenter;null!==t&&t({thumb:M,lens:X,large:Y,x:T.x,y:T.y})}function c(n){if(void 0!==j[n.thumb.id])return M=n.thumb,!1;var t,o=new Image,l=new Image,s=n.thumb,r=s.get(0),m=r.id,d=e(n.largeWrapper),g=n.zoom||r.getAttribute("data-zoom")||L,h=n.zoomMin||q,p=n.zoomMax||I,c=n.mode||r.getAttribute("data-mode")||O,v=n.eventType||r.getAttribute("data-eventType")||U,y=void 0!==n.onthumbenter?n.onthumbenter:C.onthumbenter,b=void 0!==n.onthumbleave?n.onthumbleave:C.onthumbleave,x=void 0!==n.onthumbmove?n.onthumbmove:C.onthumbmove;if(t=s.data("original")||z.full||s.attr("src"),""===r.id&&(m=r.id="magnifier-item-"+B,B+=1),a(r,m),n.width&&d.width(n.width),n.height&&d.height(n.height),n.top){if("function"==typeof n.top)var w=n.top()+"px";else var w=n.top+"px";d.length&&(d[0].style.top=w.replace("%px","%"))}if(n.left){if("function"==typeof n.left)var H=n.left()+"px";else var H=n.left+"px";d.length&&(d[0].style.left=H.replace("%px","%"))}j[m]={zoom:g,zoomMin:h,zoomMax:p,mode:c,eventType:v,thumbCssClass:r.className,zoomAttached:!1,status:0,largeUrl:t,largeWrapperId:"outside"===c?d.attr("id"):null,largeWrapperW:"outside"===c?d.width():null,largeWrapperH:"outside"===c?d.height():null,onthumbenter:y,onthumbleave:b,onthumbmove:x},Q=s.width()/s.height()/(j[m].largeWrapperW/j[m].largeWrapperH),R=(s.parent().width()-s.width())/2,D=(s.parent().height()-s.height())/2,G=!1,e(o).on("load",function(){j[m].status=1,e(l).on("load",function(){(l.width>d.width()||l.height>d.height())&&(G=!0,f(v,r),j[m].status=2,j[m].zoom=l.height/d.height(),u(r,j[m]),i(m,r,l,d))}),l.src=j[m].largeUrl}),o.src=r.src}function v(e){T.x=e.clientX,T.y=e.clientY,l(),"hover"===U&&(P=F),F&&P&&(W.removeClass(J.magnifyHidden),m())}function y(){null!==M&&u(M,C)}var b,z=t||{},x=e(n),w=this,H=t.largeWrapper||".magnifier-preview",W=e(H),M=null,C={x:0,y:0,w:0,h:0,lensW:0,lensH:0,lensBgX:0,lensBgY:0,largeW:0,largeH:0,largeL:0,largeT:0,zoom:2,zoomMin:1.1,zoomMax:5,mode:"outside",eventType:"click",status:0,zoomAttached:!1,zoomable:void 0!==z.zoomable&&z.zoomable,onthumbenter:void 0!==z.onthumbenter?z.onthumbenter:null,onthumbmove:void 0!==z.onthumbmove?z.onthumbmove:null,onthumbleave:void 0!==z.onthumbleave?z.onthumbleave:null,onzoom:void 0!==z.onzoom?z.onzoom:null},T={t:0,l:0,x:0,y:0},B=0,k=0,N="",X=null,Y=null,A=void 0===z.bg||z.lensbg,L=void 0!==z.zoom?z.zoom:C.zoom,q=void 0!==z.zoomMin?z.zoomMin:C.zoomMin,I=void 0!==z.zoomMax?z.zoomMax:C.zoomMax,O=z.mode||C.mode,U=z.eventType||C.eventType,j={},F=!1,P=!1,Q=1,R=0,D=0,E=!0,G=!0,J={magnifyHidden:"magnify-hidden",magnifyOpaque:"magnify-opaque",magnifyFull:"magnify-fullimage"};w.update=function(){i()},w.init=function(){d(x,t)},e(window).on("scroll",y);var K=!1;e(window).resize(function(){K&&clearTimeout(K),K=setTimeout(function(){d(x,z)},1e3)}),x.on("mousemove",v),x.on("mouseout",function(){r(),P=!1,W.addClass(J.magnifyHidden)}),d(x,z)}e.fn.magnify=function(t){"use strict";var o=new n(e(this),t);return o}}(jQuery);